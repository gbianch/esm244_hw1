---
title: "Task 1 & 2"
author: "Grace Bianchi"
date: "2023-01-25"
output: html_document
---

Info/ Background



Data columns used:
- lake_id
- amphibian_species: Rana muscosa (RAMU)
- amphibian_life_stage: Eggmass, tadpole, subadult, adult.
- amphibian_number: number observed


Data Citation:  Knapp, R.A., C. Pavelka, E.E. Hegeman, and T.C. Smith. 2020. The Sierra Lakes Inventory Project: Non-Native fish and community composition of lakes and ponds in the Sierra Nevada, California ver 2. Environmental Data Initiative. https://doi.org/10.6073/pasta/d835832d7fd00d9e4466e44eea87fab3

```{r setup, include= TRUE, message = FALSE, warning = FALSE, echo = TRUE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(here)
library(tidyverse)
library(patchwork)
library(readxl)
library(lubridate)
library(cowplot)

```


```{r read in the data}
sierra_amphibians_data <- read_xlsx(here("sierra_amphibians.xlsx")) %>% 
  mutate(survey_date = ymd(survey_date), 
         year = year(survey_date))
  
```

A graph of total mountain yellow-legged frog (Rana muscosa) count each year across all water bodies, by life stage excluding the ‘EggMass’ level. In other words, you should find the total number of adult, subadult, and tadpole yellow-legged frogs observed in the entire study region by life stage and year, but you will not use the lake ID or amphibian_location in your analyses as additional grouping variables. Hint: Convert the date to a date with the {lubridate} package, then pull just the year using the lubridate::year() function...then you can group by year to get counts. 

```{r}
yellow_legged_frog <- sierra_amphibians_data %>% 
  filter(amphibian_species == "RAMU", # filter for yellow-legged frog
         amphibian_life_stage != "EggMass") # remove any eggmass observations 

yellow_frog_summary <- yellow_legged_frog %>% 
  group_by(year, amphibian_life_stage) %>% 
  summarise(n = sum(amphibian_number))

p1 <- ggplot(data = yellow_frog_summary, aes(x = year, y = n)) +
  geom_col(aes(fill = amphibian_life_stage)) + 
  theme_light() +
  labs(x = "Year", y = "Number Observed (n)") + 
  guides(fill=guide_legend(title="Life Stage"))  # change legend title

  
```

```{r}

yellow_frog_lake <- yellow_legged_frog %>% 
  filter(amphibian_life_stage != "Tadpole") %>% # remove tadpole observations
  group_by(lake_id) %>% 
  summarize(n = sum(amphibian_number)) %>% # find counts for each lake
  slice_max(n = 5, order_by = (n)) # select lakes with highest counts

# add Lake before each id number
yellow_frog_lake$lake_id <- sub("^", "Lake ", yellow_frog_lake$lake_id) 

p2 <- ggplot(data = yellow_frog_lake, aes(x = reorder(lake_id, n), y = n)) +
  geom_col(fill = "lightblue", show.legend = FALSE) +
  theme_light() +
  labs(y = "Total Observed Counts (n)",
       x = " ")



```

```{r}
(p1 + theme(legend.position = "bottom")) + p2 +
  plot_annotation(title = 'Composite Graph Title', tag_levels = "A") 


```

Figure 1. Graph of the number of yellow-legged frogs observed since 
